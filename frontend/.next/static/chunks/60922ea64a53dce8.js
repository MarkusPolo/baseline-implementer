(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96086,(e,t,r)=>{t.exports=e.r(9187)},75332,e=>{"use strict";let t=(0,e.i(35884).default)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);e.s(["Terminal",()=>t],75332)},6305,e=>{"use strict";let t=(0,e.i(35884).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],6305)},33189,e=>{"use strict";let t=(0,e.i(35884).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],33189)},35884,e=>{"use strict";var t=e.i(30668);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:o="",children:i,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...s,width:r,height:r,stroke:e,strokeWidth:n?24*Number(l)/Number(r):l,className:a("lucide",o),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(i)?i:[i]])),n=(e,s)=>{let n=(0,t.forwardRef)(({className:n,...o},i)=>(0,t.createElement)(l,{ref:i,iconNode:s,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...o}));return n.displayName=r(e),n};e.s(["default",()=>n],35884)},3333,e=>{"use strict";let t=(0,e.i(35884).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],3333)},49449,e=>{"use strict";let t=(0,e.i(35884).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],49449)},15767,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(49449),s=e.i(3333),l=e.i(6305),n=e.i(33189),o=e.i(35884);let i=(0,o.default)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),d=(0,o.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var c=e.i(75332);function u({initialSteps:e,initialName:o="",initialDescription:u="",onSave:p,onCancel:x}){let[m,h]=(0,r.useState)(o),[g,b]=(0,r.useState)(u),[f,y]=(0,r.useState)(0===e.length?[]:"string"==typeof e[0]?e.map(e=>({type:"send",cmd:e,wait_prompt:!0})):e),v=[{regex:/(password\s+)(\S+)/gi,replace:"$1{{password}}"},{regex:/(secret\s+)(\S+)/gi,replace:"$1{{secret}}"},{regex:/(snmp-server community\s+)(\S+)/gi,replace:"$1{{community_string}}"},{regex:/(key-string\s+)(\S+)/gi,replace:"$1{{key_string}}"}],j=e=>{let t=new Set;e.forEach(e=>{let r=(e.cmd+(e.pattern||"")+(e.response||"")).match(/\{\{([^}]+)\}\}/g);r&&r.forEach(e=>t.add(e.replace(/\{\{|\}\}/g,"").trim()))});let r={type:"object",properties:{},required:[]};return t.forEach(e=>{r.properties[e]={type:"string",title:e},r.required.push(e)}),r},N=Object.keys(j(f).properties),w=(e,t,r)=>{let a=[...f];a[e]={...a[e],[t]:r},y(a)},k=(e,t)=>{if("up"===t&&0===e||"down"===t&&e===f.length-1)return;let r=[...f],a="up"===t?e-1:e+1;[r[e],r[a]]=[r[a],r[e]],y(r)};return(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:x,className:"p-2 rounded-full hover:bg-neutral-800 text-neutral-400 transition-colors",children:(0,t.jsx)(n.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Template Editor"})]}),(0,t.jsxs)("button",{onClick:()=>{let e=j(f);p(m,g,f,e)},disabled:!m||0===f.length,className:"flex items-center gap-2 rounded-lg bg-emerald-600 px-6 py-2 text-sm font-semibold text-white hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-900/20 disabled:opacity-50",children:[(0,t.jsx)(l.Save,{className:"h-4 w-4"}),"Save Template"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-neutral-400",children:"Template Name"}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"e.g., Core Switch Baseline",className:"w-full bg-neutral-900 border border-neutral-800 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-neutral-400",children:"Description"}),(0,t.jsx)("textarea",{value:g,onChange:e=>b(e.target.value),placeholder:"What does this template do?",rows:4,className:"w-full bg-neutral-900 border border-neutral-800 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-neutral-500 uppercase tracking-widest",children:"Detected Variables"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 min-h-[40px] p-2 bg-neutral-900/50 rounded-lg border border-neutral-800",children:0===N.length?(0,t.jsxs)("span",{className:"text-xs text-neutral-600 italic",children:["No variables detected. Add ","{{var}}","."]}):N.map(e=>(0,t.jsx)("span",{className:"px-2 py-1 rounded bg-blue-500/20 text-blue-400 text-xs border border-blue-500/30",children:e},e))})]}),(0,t.jsxs)("div",{className:"space-y-3 pt-4 border-t border-neutral-800",children:[(0,t.jsx)("h4",{className:"text-xs font-bold text-neutral-500 uppercase tracking-widest",children:"Automation Helpers"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,t.jsxs)("button",{onClick:()=>{y(f.map(e=>{let t=e.cmd;return t=(t=(t=(t=(t=(t=t.replace(/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/,"{{ip_address}}")).replace(/(vlan\s+)(\d+)/i,"$1{{vlan_id}}")).replace(/(hostname\s+)(\S+)/i,"$1{{hostname}}")).replace(/(interface\s+)(\S+)/i,"$1{{interface_name}}")).replace(/(description\s+)(\S+)/i,"$1{{interface_description}}")).replace(/(ip default-gateway\s+)(\S+)/i,"$1{{default_gateway}}"),{...e,cmd:t}}))},className:"flex items-center justify-center gap-2 text-xs font-semibold py-2.5 rounded-lg bg-blue-500/10 text-blue-400 border border-blue-500/20 hover:bg-blue-500/20 transition-all group",children:[(0,t.jsx)(i,{className:"h-3.5 w-3.5 group-hover:rotate-12 transition-transform"}),"Suggest Variables"]}),(0,t.jsxs)("button",{onClick:()=>{y(f.map(e=>{let t=e.cmd;return v.forEach(e=>{t=t.replace(e.regex,e.replace)}),{...e,cmd:t}}))},className:"flex items-center justify-center gap-2 text-xs font-semibold py-2.5 rounded-lg bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 hover:bg-emerald-500/20 transition-all group",children:[(0,t.jsx)(d,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"}),"Redact Secrets"]})]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-neutral-300",children:"Command Sequence"}),(0,t.jsxs)("button",{onClick:()=>{y([...f,{type:"send",cmd:"",wait_prompt:!0}])},className:"flex items-center gap-1 text-xs text-blue-400 hover:text-blue-300 transition-colors",children:[(0,t.jsx)(s.Plus,{className:"h-3 w-3"})," Add Step"]})]}),(0,t.jsx)("div",{className:"space-y-3 h-[600px] overflow-auto pr-2 custom-scrollbar",children:f.map((e,r)=>(0,t.jsxs)("div",{className:"flex flex-col gap-3 p-4 rounded-xl bg-neutral-900 border border-neutral-800 group hover:border-neutral-700 transition-all relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex flex-col gap-1 items-center bg-neutral-800/50 rounded p-1",children:(0,t.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,t.jsx)("button",{onClick:()=>k(r,"up"),className:"p-0.5 hover:text-white text-neutral-600 disabled:opacity-30",disabled:0===r,children:(0,t.jsx)("div",{className:"w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[6px] border-b-current"})}),(0,t.jsx)("button",{onClick:()=>k(r,"down"),className:"p-0.5 hover:text-white text-neutral-600 disabled:opacity-30",disabled:r===f.length-1,children:(0,t.jsx)("div",{className:"w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[6px] border-t-current"})})]})}),(0,t.jsxs)("select",{value:e.type,onChange:e=>w(r,"type",e.target.value),className:"bg-neutral-800 border-none rounded px-2 py-1 text-xs text-neutral-300 focus:ring-1 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"send",children:"Send Command"}),(0,t.jsx)("option",{value:"expect",children:"Expect/Send"}),(0,t.jsx)("option",{value:"verify",children:"Verify Output"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["send"===e.type&&(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 rounded-md bg-neutral-800/50",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.wait_prompt,onChange:e=>w(r,"wait_prompt",e.target.checked),className:"rounded border-neutral-700 bg-neutral-800 text-blue-600 focus:ring-blue-500/20"}),(0,t.jsx)("span",{className:"text-[10px] text-neutral-500 font-bold uppercase tracking-widest",children:"Wait Prompt"})]}),(0,t.jsx)("button",{onClick:()=>{y(f.filter((e,t)=>t!==r))},className:"p-1.5 rounded-md hover:bg-rose-500/10 text-neutral-600 hover:text-rose-500 transition-colors",children:(0,t.jsx)(a.Trash2,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"pl-9 space-y-3",children:["send"===e.type&&(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-neutral-950 rounded-lg px-3 py-2 border border-neutral-800/50",children:[(0,t.jsx)(c.Terminal,{className:"h-3.5 w-3.5 text-neutral-600"}),(0,t.jsx)("input",{type:"text",value:e.cmd,onChange:e=>w(r,"cmd",e.target.value),className:"w-full bg-transparent border-none p-0 text-sm text-neutral-200 focus:outline-none focus:ring-0 font-mono",placeholder:"Command to send..."})]}),"expect"===e.type&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-[10px] uppercase font-bold text-neutral-600 tracking-widest pl-1 text-rose-500/80",children:"Wait For (Pattern)"}),(0,t.jsx)("input",{type:"text",value:e.pattern||"",onChange:e=>w(r,"pattern",e.target.value),className:"w-full bg-neutral-950 border border-neutral-800 rounded-lg px-3 py-2 text-sm text-neutral-200 focus:outline-none focus:ring-1 focus:ring-rose-500/30 font-mono",placeholder:"e.g. [confirm]"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-[10px] uppercase font-bold text-neutral-600 tracking-widest pl-1 text-emerald-500/80",children:"Then Send"}),(0,t.jsx)("input",{type:"text",value:e.response||"",onChange:e=>w(r,"response",e.target.value),className:"w-full bg-neutral-950 border border-neutral-800 rounded-lg px-3 py-2 text-sm text-neutral-200 focus:outline-none focus:ring-1 focus:ring-emerald-500/30 font-mono",placeholder:"e.g. y"})]})]}),"verify"===e.type&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-neutral-950 rounded-lg px-3 py-2 border border-neutral-800/50",children:[(0,t.jsx)(c.Terminal,{className:"h-3.5 w-3.5 text-neutral-600"}),(0,t.jsx)("input",{type:"text",value:e.cmd,onChange:e=>w(r,"cmd",e.target.value),className:"w-full bg-transparent border-none p-0 text-sm text-neutral-200 focus:outline-none focus:ring-0 font-mono",placeholder:"Command to run for verify (e.g. show run)..."})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-[10px] uppercase font-bold text-neutral-600 tracking-widest pl-1 text-blue-500/80",children:"Expect Regex Pattern"}),(0,t.jsx)("textarea",{value:e.pattern||"",onChange:e=>w(r,"pattern",e.target.value),className:"w-full bg-neutral-950 border border-neutral-800 rounded-lg px-3 py-2 text-sm text-neutral-200 focus:outline-none focus:ring-1 focus:ring-blue-500/30 font-mono min-h-[80px]",placeholder:"Regex to match (supports multi-line)..."})]})]})]})]},r))}),0===f.length&&(0,t.jsx)("div",{className:"py-24 text-center rounded-2xl border border-neutral-800 border-dashed text-neutral-600 text-sm bg-neutral-900/20",children:"No steps in sequence. Add one above."})]})]})]})}e.s(["MacroEditor",()=>u],15767)},20560,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(96086),s=e.i(15767);function l({params:e}){let l=(0,a.useRouter)(),{id:n}=e,[o,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{n&&fetch(`/api/macros/${n}`).then(e=>{if(!e.ok)throw Error("Macro not found");return e.json()}).then(e=>i(e)).catch(e=>{console.error(e),alert("Failed to load macro"),l.push("/macros")}).finally(()=>c(!1))},[n,l]);let u=async(e,t,r,a)=>{try{let s=await fetch(`/api/macros/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:t,steps:r,config_schema:a})});if(s.ok)alert("Macro updated successfully!"),l.push("/macros");else{let e=await s.json();alert(`Error: ${JSON.stringify(e.detail)}`)}}catch(e){console.error(e),alert("Failed to update macro")}};return d?(0,t.jsx)("div",{className:"text-center py-12 text-neutral-500",children:"Loading macro..."}):o?(0,t.jsx)("div",{className:"mx-auto max-w-4xl py-6",children:(0,t.jsx)(s.MacroEditor,{initialSteps:o.steps,initialName:o.name,initialDescription:o.description,onSave:u,onCancel:()=>l.push("/macros")})}):null}e.s(["default",()=>l])}]);